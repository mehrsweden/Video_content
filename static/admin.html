<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Hub - Admin Panel</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .file-drop-zone {
            border: 2px dashed #cbd5e0;
            transition: all 0.3s ease;
        }
        .file-drop-zone.dragover {
            border-color: #3182ce;
            background-color: #ebf8ff;
        }
        .thumbnail-preview {
            max-width: 200px;
            max-height: 150px;
            object-fit: cover;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Header -->
    <header class="bg-blue-600 text-white shadow-lg">
        <div class="container mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <h1 class="text-2xl font-bold">Content Hub - Admin Panel</h1>
                <div class="flex space-x-4">
                    <a href="/documents" class="bg-green-500 hover:bg-green-600 px-4 py-2 rounded transition-colors">
                        <i class="fas fa-download mr-2"></i>View Documents
                    </a>
                    <a href="/" class="bg-blue-500 hover:bg-blue-700 px-4 py-2 rounded transition-colors">
                        <i class="fas fa-eye mr-2"></i>View Site
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-white shadow-md">
        <div class="container mx-auto px-6">
            <div class="flex space-x-8 py-4">
                <button id="videos-tab" class="nav-btn px-4 py-2 rounded font-semibold transition-all duration-300 bg-blue-500 text-white">
                    <i class="fas fa-video mr-2"></i>Videos
                </button>
                <button id="texts-tab" class="nav-btn px-4 py-2 rounded font-semibold transition-all duration-300 text-gray-600 hover:text-blue-500">
                    <i class="fas fa-file-text mr-2"></i>Articles
                </button>
                <button id="documents-tab" class="nav-btn px-4 py-2 rounded font-semibold transition-all duration-300 text-gray-600 hover:text-blue-500">
                    <i class="fas fa-file-download mr-2"></i>Documents
                </button>
                <button id="files-tab" class="nav-btn px-4 py-2 rounded font-semibold transition-all duration-300 text-gray-600 hover:text-blue-500">
                    <i class="fas fa-folder mr-2"></i>File Manager
                </button>
            </div>
        </div>
    </nav>

    <!-- Videos Management Section -->
    <section id="videos-section" class="container mx-auto px-6 py-8">
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <h2 class="text-xl font-bold mb-4">Add New Video</h2>
            
            <!-- File Upload Section -->
            <div class="mb-6">
                <h3 class="text-lg font-semibold mb-3">Upload Video File</h3>
                <div id="video-drop-zone" class="file-drop-zone p-8 text-center rounded-lg cursor-pointer">
                    <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                    <p class="text-gray-600 mb-2">Drag and drop a video file here, or click to select</p>
                    <p class="text-sm text-gray-500">Supported formats: MP4, MOV, AVI, WMV, FLV, MKV, WEBM, M4V</p>
                    <input type="file" id="video-file-input" accept="video/*" class="hidden">
                </div>
                <div id="video-upload-progress" class="hidden mt-4">
                    <div class="bg-gray-200 rounded-full h-2">
                        <div id="video-progress-bar" class="bg-blue-600 h-2 rounded-full" style="width: 0%"></div>
                    </div>
                    <p id="video-upload-status" class="text-sm text-gray-600 mt-2">Uploading...</p>
                </div>
            </div>

            <form id="video-form" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Title *</label>
                    <input type="text" id="video-title" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Video URL *</label>
                    <input type="url" id="video-url" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Thumbnail URL</label>
                    <input type="url" id="video-thumbnail" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Order Index</label>
                    <input type="number" id="video-order" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" value="0">
                </div>
                <div class="md:col-span-2">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                    <textarea id="video-description" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                </div>
                <div class="md:col-span-2" id="thumbnail-preview-container" style="display: none;">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Thumbnail Preview</label>
                    <img id="thumbnail-preview" class="thumbnail-preview rounded border" alt="Thumbnail preview">
                </div>
                <div class="md:col-span-2 flex items-center">
                    <input type="checkbox" id="video-published" class="mr-2" checked>
                    <label for="video-published" class="text-sm font-medium text-gray-700">Published</label>
                </div>
                <div class="md:col-span-2">
                    <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded transition-colors">
                        <i class="fas fa-plus mr-2"></i>Add Video
                    </button>
                    <button type="button" id="cancel-video-edit" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded transition-colors ml-2 hidden">
                        Cancel Edit
                    </button>
                </div>
            </form>
        </div>

        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-xl font-bold mb-4">Manage Videos</h2>
            <div id="videos-list" class="space-y-4">
                <!-- Videos will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Texts Management Section -->
   <!-- Replace your current texts-section in admin.html with this updated version -->
<section id="texts-section" class="container mx-auto px-6 py-8 hidden">
    <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
        <h2 class="text-xl font-bold mb-4">Add New Article</h2>
        
        <!-- File Upload Section for Articles -->
        <div class="mb-6">
            <h3 class="text-lg font-semibold mb-3">Upload Files for Article</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <!-- Image Upload -->
                <div>
                    <h4 class="font-medium mb-2">Upload Images</h4>
                    <div id="article-image-drop-zone" class="file-drop-zone p-4 text-center rounded-lg cursor-pointer">
                        <i class="fas fa-image text-2xl text-gray-400 mb-2"></i>
                        <p class="text-sm text-gray-600">Drop images here</p>
                        <input type="file" id="article-image-input" accept="image/*" class="hidden" multiple>
                    </div>
                </div>
                
                <!-- Document Upload -->
                <div>
                    <h4 class="font-medium mb-2">Upload Documents</h4>
                    <div id="article-doc-drop-zone" class="file-drop-zone p-4 text-center rounded-lg cursor-pointer">
                        <i class="fas fa-file-alt text-2xl text-gray-400 mb-2"></i>
                        <p class="text-sm text-gray-600">Drop files here</p>
                        <input type="file" id="article-doc-input" accept=".pdf,.doc,.docx,.txt,.md" class="hidden" multiple>
                    </div>
                </div>
            </div>
            
            <!-- Upload Progress -->
            <div id="article-upload-progress" class="hidden mb-4">
                <div class="bg-gray-200 rounded-full h-2">
                    <div id="article-progress-bar" class="bg-blue-600 h-2 rounded-full" style="width: 0%"></div>
                </div>
                <p id="article-upload-status" class="text-sm text-gray-600 mt-2">Uploading...</p>
            </div>
            
            <!-- Uploaded Files List -->
            <div id="article-files-list" class="hidden">
                <h4 class="font-medium mb-2">Uploaded Files</h4>
                <div id="article-files-container" class="space-y-2"></div>
            </div>
        </div>

        <form id="text-form" class="space-y-4">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Title *</label>
                    <input type="text" id="text-title" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Order Index</label>
                    <input type="number" id="text-order" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" value="0">
                </div>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Excerpt</label>
                <textarea id="text-excerpt" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Brief summary of the article"></textarea>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Content *</label>
                <div class="mb-2">
                    <button type="button" id="insert-image-btn" class="text-xs bg-gray-200 hover:bg-gray-300 px-2 py-1 rounded mr-2" disabled>
                        <i class="fas fa-image mr-1"></i>Insert Image
                    </button>
                    <button type="button" id="insert-link-btn" class="text-xs bg-gray-200 hover:bg-gray-300 px-2 py-1 rounded" disabled>
                        <i class="fas fa-link mr-1"></i>Insert File Link
                    </button>
                </div>
                <textarea id="text-content" rows="8" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required placeholder="You can write in Markdown format. Upload files above and use the buttons to insert them."></textarea>
            </div>
            <div class="flex items-center">
                <input type="checkbox" id="text-published" class="mr-2" checked>
                <label for="text-published" class="text-sm font-medium text-gray-700">Published</label>
            </div>
            <div>
                <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded transition-colors">
                    <i class="fas fa-plus mr-2"></i>Add Article
                </button>
                <button type="button" id="cancel-text-edit" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded transition-colors ml-2 hidden">
                    Cancel Edit
                </button>
            </div>
        </form>
    </div>

    <div class="bg-white rounded-lg shadow-lg p-6">
        <h2 class="text-xl font-bold mb-4">Manage Articles</h2>
        <div id="texts-list" class="space-y-4">
            <!-- Texts will be loaded here -->
        </div>
    </div>
</section>

<script>
    // Add these variables to your global variables section (at the top of script)
let articleUploadedFiles = [];

// Replace your setupFileUpload function with this updated version:
function setupFileUpload() {
    // Video upload in video section
    setupDropZone('video-drop-zone', 'video-file-input', 'video', handleVideoFileUpload);
    
    // Document upload in document section
    setupDropZone('document-drop-zone', 'document-file-input', 'document', handleDocumentFileUpload);
    
    // Article file uploads
    setupDropZone('article-image-drop-zone', 'article-image-input', 'image', handleArticleFileUpload);
    setupDropZone('article-doc-drop-zone', 'article-doc-input', 'document', handleArticleFileUpload);
    
    // File manager uploads
    setupDropZone('file-video-drop-zone', 'file-video-input', 'video', handleFileUpload);
    setupDropZone('file-image-drop-zone', 'file-image-input', 'image', handleFileUpload);
    setupDropZone('file-document-drop-zone', 'file-document-input', 'document', handleFileUpload);
    
    // Article insert buttons
    const insertImageBtn = document.getElementById('insert-image-btn');
    const insertLinkBtn = document.getElementById('insert-link-btn');
    
    if (insertImageBtn) insertImageBtn.addEventListener('click', showImageInsertModal);
    if (insertLinkBtn) insertLinkBtn.addEventListener('click', showLinkInsertModal);
}

// Add these new functions for article file handling:

// Handle article file uploads
async function handleArticleFileUpload(files, fileType) {
    if (!files) return;
    
    // Handle single file or multiple files
    const fileArray = files.length ? Array.from(files) : [files];
    
    const progressContainer = document.getElementById('article-upload-progress');
    const progressBar = document.getElementById('article-progress-bar');
    const statusText = document.getElementById('article-upload-status');
    
    // Show progress container
    if (progressContainer) {
        progressContainer.classList.remove('hidden');
    }
    
    for (let i = 0; i < fileArray.length; i++) {
        const file = fileArray[i];
        const formData = new FormData();
        formData.append('file', file);
        formData.append('type', fileType);
        
        try {
            if (statusText) {
                statusText.textContent = `Uploading ${file.name} (${i + 1}/${fileArray.length})...`;
            }
            if (progressBar) {
                progressBar.style.width = `${((i / fileArray.length) * 100)}%`;
            }
            
            const response = await fetch('/api/upload', {
                method: 'POST',
                body: formData
            });

            if (response.ok) {
                const result = await response.json();
                
                // Add to uploaded files list
                articleUploadedFiles.push({
                    name: file.name,
                    url: result.url,
                    type: fileType,
                    size: result.size,
                    originalName: result.original_name
                });
                
                updateArticleFilesList();
                console.log(`✅ Uploaded: ${file.name}`);
                
            } else {
                throw new Error(`Upload failed for ${file.name}`);
            }
        } catch (error) {
            console.error('Upload error:', error);
            if (statusText) {
                statusText.textContent = `Upload failed for ${file.name}`;
                statusText.classList.add('text-red-600');
            }
        }
    }
    
    if (statusText) {
        statusText.textContent = 'All uploads completed!';
        statusText.classList.remove('text-red-600');
    }
    if (progressBar) {
        progressBar.style.width = '100%';
    }
    
    setTimeout(() => {
        if (progressContainer) {
            progressContainer.classList.add('hidden');
        }
        if (progressBar) {
            progressBar.style.width = '0%';
        }
    }, 2000);
}

// Update the files list display
function updateArticleFilesList() {
    const filesList = document.getElementById('article-files-list');
    const filesContainer = document.getElementById('article-files-container');
    
    if (!filesList || !filesContainer) return;
    
    if (articleUploadedFiles.length === 0) {
        filesList.classList.add('hidden');
        return;
    }
    
    filesList.classList.remove('hidden');
    
    // Enable insert buttons
    const insertImageBtn = document.getElementById('insert-image-btn');
    const insertLinkBtn = document.getElementById('insert-link-btn');
    
    if (insertImageBtn) insertImageBtn.disabled = false;
    if (insertLinkBtn) insertLinkBtn.disabled = false;
    
    filesContainer.innerHTML = articleUploadedFiles.map((file, index) => `
        <div class="flex items-center justify-between p-2 bg-gray-50 rounded">
            <div class="flex items-center">
                <i class="fas fa-${file.type === 'image' ? 'image' : 'file-alt'} mr-2 text-blue-500"></i>
                <span class="text-sm font-medium">${file.originalName}</span>
                <span class="text-xs text-gray-500 ml-2">(${(file.size / 1024 / 1024).toFixed(2)} MB)</span>
            </div>
            <div class="flex space-x-2">
                <button onclick="copyFileUrl('${file.url}')" class="text-blue-500 hover:text-blue-700 text-xs">
                    <i class="fas fa-copy"></i> Copy URL
                </button>
                <button onclick="removeArticleFile(${index})" class="text-red-500 hover:text-red-700 text-xs">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
    `).join('');
}

// Remove file from article files
function removeArticleFile(index) {
    articleUploadedFiles.splice(index, 1);
    updateArticleFilesList();
}

// Copy file URL to clipboard
function copyFileUrl(url) {
    navigator.clipboard.writeText(url).then(() => {
        console.log('URL copied to clipboard:', url);
        // Simple notification
        const notification = document.createElement('div');
        notification.textContent = 'URL copied to clipboard!';
        notification.style.cssText = 'position: fixed; top: 20px; right: 20px; background: #10b981; color: white; padding: 10px 20px; border-radius: 4px; z-index: 1000;';
        document.body.appendChild(notification);
        setTimeout(() => document.body.removeChild(notification), 2000);
    });
}

// Show modal to insert image
function showImageInsertModal() {
    const images = articleUploadedFiles.filter(file => file.type === 'image');
    if (images.length === 0) {
        alert('No images uploaded yet. Upload images first.');
        return;
    }
    
    const imageOptions = images.map((img, index) => 
        `<option value="${img.url}">${img.originalName}</option>`
    ).join('');
    
    const modal = document.createElement('div');
    modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
    modal.innerHTML = `
        <div class="bg-white p-6 rounded-lg max-w-md w-full mx-4">
            <h3 class="text-lg font-bold mb-4">Insert Image</h3>
            <div class="mb-4">
                <label class="block text-sm font-medium mb-2">Select Image:</label>
                <select id="image-select" class="w-full p-2 border rounded">
                    ${imageOptions}
                </select>
            </div>
            <div class="mb-4">
                <label class="block text-sm font-medium mb-2">Alt Text:</label>
                <input type="text" id="alt-text" class="w-full p-2 border rounded" placeholder="Describe the image">
            </div>
            <div class="flex space-x-2">
                <button onclick="insertImageMarkdown()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                    Insert
                </button>
                <button onclick="closeModal()" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">
                    Cancel
                </button>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    window.currentModal = modal;
}

// Show modal to insert file link
function showLinkInsertModal() {
    const files = articleUploadedFiles.filter(file => file.type === 'document');
    if (files.length === 0) {
        alert('No documents uploaded yet. Upload documents first.');
        return;
    }
    
    const fileOptions = files.map((file, index) => 
        `<option value="${file.url}">${file.originalName}</option>`
    ).join('');
    
    const modal = document.createElement('div');
    modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
    modal.innerHTML = `
        <div class="bg-white p-6 rounded-lg max-w-md w-full mx-4">
            <h3 class="text-lg font-bold mb-4">Insert File Link</h3>
            <div class="mb-4">
                <label class="block text-sm font-medium mb-2">Select File:</label>
                <select id="file-select" class="w-full p-2 border rounded">
                    ${fileOptions}
                </select>
            </div>
            <div class="mb-4">
                <label class="block text-sm font-medium mb-2">Link Text:</label>
                <input type="text" id="link-text" class="w-full p-2 border rounded" placeholder="Click here to download">
            </div>
            <div class="flex space-x-2">
                <button onclick="insertLinkMarkdown()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                    Insert
                </button>
                <button onclick="closeModal()" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">
                    Cancel
                </button>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    window.currentModal = modal;
}

// Insert image markdown
function insertImageMarkdown() {
    const imageUrl = document.getElementById('image-select').value;
    const altText = document.getElementById('alt-text').value || 'Image';
    const markdown = `![${altText}](${imageUrl})`;
    
    insertIntoTextarea(markdown);
    closeModal();
}

// Insert link markdown
function insertLinkMarkdown() {
    const fileUrl = document.getElementById('file-select').value;
    const linkText = document.getElementById('link-text').value || 'Download File';
    const markdown = `[${linkText}](${fileUrl})`;
    
    insertIntoTextarea(markdown);
    closeModal();
}

// Insert text into textarea at cursor position
function insertIntoTextarea(text) {
    const textarea = document.getElementById('text-content');
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const currentText = textarea.value;
    
    textarea.value = currentText.substring(0, start) + text + currentText.substring(end);
    textarea.focus();
    textarea.setSelectionRange(start + text.length, start + text.length);
}

// Close modal
function closeModal() {
    if (window.currentModal) {
        document.body.removeChild(window.currentModal);
        window.currentModal = null;
    }
}

// Update your cancelTextEdit function to clear article files
function cancelTextEdit() {
    editingTextId = null;
    document.getElementById('cancel-text-edit').classList.add('hidden');
    document.querySelector('#text-form button[type="submit"]').innerHTML = '<i class="fas fa-plus mr-2"></i>Add Article';
    document.getElementById('text-form').reset();
    document.getElementById('text-published').checked = true;
    
    // Clear article files
    articleUploadedFiles = [];
    updateArticleFilesList();
    
    const insertImageBtn = document.getElementById('insert-image-btn');
    const insertLinkBtn = document.getElementById('insert-link-btn');
    if (insertImageBtn) insertImageBtn.disabled = true;
    if (insertLinkBtn) insertLinkBtn.disabled = true;
}
</script>
                

    <!-- Documents Management Section -->
    <section id="documents-section" class="container mx-auto px-6 py-8 hidden">
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <h2 class="text-xl font-bold mb-4">Add New Document</h2>
            
            <!-- Document Upload Section -->
            <div class="mb-6">
                <h3 class="text-lg font-semibold mb-3">Upload Document File</h3>
                <div id="document-drop-zone" class="file-drop-zone p-8 text-center rounded-lg cursor-pointer">
                    <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                    <p class="text-gray-600 mb-2">Drag and drop a document here, or click to select</p>
                    <p class="text-sm text-gray-500">Supported formats: PDF, DOC, DOCX, XLS, XLSX, PPT, PPTX, TXT, ZIP, RAR</p>
                    <input type="file" id="document-file-input" accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.zip,.rar" class="hidden">
                </div>
                <div id="document-upload-progress" class="hidden mt-4">
                    <div class="bg-gray-200 rounded-full h-2">
                        <div id="document-progress-bar" class="bg-green-600 h-2 rounded-full" style="width: 0%"></div>
                    </div>
                    <p id="document-upload-status" class="text-sm text-gray-600 mt-2">Uploading...</p>
                </div>
            </div>

            <form id="document-form" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Title *</label>
                    <input type="text" id="document-title" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">File URL *</label>
                    <input type="url" id="document-url" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" required>
                </div>
                <div class="md:col-span-2">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                    <textarea id="document-description" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="What is this document about?"></textarea>
                </div>
                <div class="md:col-span-2 flex items-center">
                    <input type="checkbox" id="document-published" class="mr-2" checked>
                    <label for="document-published" class="text-sm font-medium text-gray-700">Published (visible on /documents page)</label>
                </div>
                <div class="md:col-span-2">
                    <button type="submit" class="bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded transition-colors">
                        <i class="fas fa-plus mr-2"></i>Add Document
                    </button>
                    <button type="button" id="cancel-document-edit" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded transition-colors ml-2 hidden">
                        Cancel Edit
                    </button>
                </div>
            </form>
        </div>

        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-xl font-bold mb-4">Manage Documents</h2>
            <div id="documents-list" class="space-y-4">
                <!-- Documents will be loaded here -->
            </div>
        </div>
    </section>

    <!-- File Manager Section -->
    <section id="files-section" class="container mx-auto px-6 py-8 hidden">
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <h2 class="text-xl font-bold mb-4">Upload Files</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Video Upload -->
                <div>
                    <h3 class="text-lg font-semibold mb-3">Upload Video</h3>
                    <div id="file-video-drop-zone" class="file-drop-zone p-6 text-center rounded-lg cursor-pointer">
                        <i class="fas fa-video text-3xl text-gray-400 mb-2"></i>
                        <p class="text-sm text-gray-600">Drop video file here</p>
                        <input type="file" id="file-video-input" accept="video/*" class="hidden">
                    </div>
                </div>

                <!-- Image Upload -->
                <div>
                    <h3 class="text-lg font-semibold mb-3">Upload Image</h3>
                    <div id="file-image-drop-zone" class="file-drop-zone p-6 text-center rounded-lg cursor-pointer">
                        <i class="fas fa-image text-3xl text-gray-400 mb-2"></i>
                        <p class="text-sm text-gray-600">Drop image file here</p>
                        <input type="file" id="file-image-input" accept="image/*" class="hidden">
                    </div>
                </div>

                <!-- Document Upload -->
                <div>
                    <h3 class="text-lg font-semibold mb-3">Upload Document</h3>
                    <div id="file-document-drop-zone" class="file-drop-zone p-6 text-center rounded-lg cursor-pointer">
                        <i class="fas fa-file-alt text-3xl text-gray-400 mb-2"></i>
                        <p class="text-sm text-gray-600">Drop document here</p>
                        <input type="file" id="file-document-input" accept=".pdf,.doc,.docx,.txt,.md" class="hidden">
                    </div>
                </div>
            </div>

            <div id="file-upload-progress" class="hidden mt-6">
                <div class="bg-gray-200 rounded-full h-2">
                    <div id="file-progress-bar" class="bg-blue-600 h-2 rounded-full" style="width: 0%"></div>
                </div>
                <p id="file-upload-status" class="text-sm text-gray-600 mt-2">Uploading...</p>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-xl font-bold mb-4">File Manager</h2>
            <div id="files-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <!-- Files will be loaded here -->
            </div>
        </div>
    </section>

    <script>
        let currentVideos = [];
        let currentTexts = [];
        let currentFiles = [];
        let currentDocuments = [];
        let editingVideoId = null;
        let editingTextId = null;
        let editingDocumentId = null;

        // DOM elements
        const videosTab = document.getElementById('videos-tab');
        const textsTab = document.getElementById('texts-tab');
        const documentsTab = document.getElementById('documents-tab');
        const filesTab = document.getElementById('files-tab');
        const videosSection = document.getElementById('videos-section');
        const textsSection = document.getElementById('texts-section');
        const documentsSection = document.getElementById('documents-section');
        const filesSection = document.getElementById('files-section');

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Admin panel loading...');
            loadVideos();
            setupEventListeners();
            setupFileUpload();
        });

        // Setup event listeners
        function setupEventListeners() {
            videosTab.addEventListener('click', () => switchTab('videos'));
            textsTab.addEventListener('click', () => switchTab('texts'));
            documentsTab.addEventListener('click', () => switchTab('documents'));
            filesTab.addEventListener('click', () => switchTab('files'));
            
            document.getElementById('video-form').addEventListener('submit', handleVideoSubmit);
            document.getElementById('text-form').addEventListener('submit', handleTextSubmit);
            document.getElementById('document-form').addEventListener('submit', handleDocumentSubmit);
            
            document.getElementById('cancel-video-edit').addEventListener('click', cancelVideoEdit);
            document.getElementById('cancel-text-edit').addEventListener('click', cancelTextEdit);
            document.getElementById('cancel-document-edit').addEventListener('click', cancelDocumentEdit);

            // Thumbnail preview
            document.getElementById('video-thumbnail').addEventListener('input', updateThumbnailPreview);
        }

        // Setup file upload functionality
        function setupFileUpload() {
            // Video upload in video section
            setupDropZone('video-drop-zone', 'video-file-input', 'video', handleVideoFileUpload);
            
            // Document upload in document section
            setupDropZone('document-drop-zone', 'document-file-input', 'document', handleDocumentFileUpload);
            
            // File manager uploads
            setupDropZone('file-video-drop-zone', 'file-video-input', 'video', handleFileUpload);
            setupDropZone('file-image-drop-zone', 'file-image-input', 'image', handleFileUpload);
            setupDropZone('file-document-drop-zone', 'file-document-input', 'document', handleFileUpload);
        }

        // Setup drag and drop zone
        function setupDropZone(dropZoneId, inputId, fileType, handler) {
            const dropZone = document.getElementById(dropZoneId);
            const fileInput = document.getElementById(inputId);

            if (!dropZone || !fileInput) return;

            dropZone.addEventListener('click', () => fileInput.click());
            fileInput.addEventListener('change', (e) => handler(e.target.files[0], fileType));

            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('dragover');
            });

            dropZone.addEventListener('dragleave', () => {
                dropZone.classList.remove('dragover');
            });

            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handler(files[0], fileType);
                }
            });
        }

        // Handle video file upload in video section
        async function handleVideoFileUpload(file, fileType) {
            if (!file) return;

            const progressContainer = document.getElementById('video-upload-progress');
            const progressBar = document.getElementById('video-progress-bar');
            const statusText = document.getElementById('video-upload-status');

            progressContainer.classList.remove('hidden');
            
            const formData = new FormData();
            formData.append('file', file);
            formData.append('type', fileType);

            try {
                const response = await fetch('/api/upload', {
                    method: 'POST',
                    body: formData
                });

                if (response.ok) {
                    const result = await response.json();
                    document.getElementById('video-url').value = result.url;
                    if (result.thumbnail_url) {
                        document.getElementById('video-thumbnail').value = result.thumbnail_url;
                        updateThumbnailPreview();
                    }
                    statusText.textContent = 'Upload completed successfully!';
                    progressBar.style.width = '100%';
                    
                    setTimeout(() => {
                        progressContainer.classList.add('hidden');
                        progressBar.style.width = '0%';
                    }, 2000);
                } else {
                    throw new Error('Upload failed');
                }
            } catch (error) {
                console.error('Upload error:', error);
                statusText.textContent = 'Upload failed. Please try again.';
                statusText.classList.add('text-red-600');
            }
        }

        // Handle document file upload in document section
        async function handleDocumentFileUpload(file, fileType) {
            if (!file) return;

            const progressContainer = document.getElementById('document-upload-progress');
            const progressBar = document.getElementById('document-progress-bar');
            const statusText = document.getElementById('document-upload-status');

            progressContainer.classList.remove('hidden');
            
            const formData = new FormData();
            formData.append('file', file);
            formData.append('type', fileType);

            try {
                const response = await fetch('/api/upload', {
                    method: 'POST',
                    body: formData
                });

                if (response.ok) {
                    const result = await response.json();
                    document.getElementById('document-url').value = result.url;
                    document.getElementById('document-title').value = result.original_name;
                    statusText.textContent = 'Upload completed successfully!';
                    progressBar.style.width = '100%';
                    
                    setTimeout(() => {
                        progressContainer.classList.add('hidden');
                        progressBar.style.width = '0%';
                    }, 2000);
                } else {
                    throw new Error('Upload failed');
                }
            } catch (error) {
                console.error('Upload error:', error);
                statusText.textContent = 'Upload failed. Please try again.';
                statusText.classList.add('text-red-600');
            }
        }

        // Handle file upload in file manager
        async function handleFileUpload(file, fileType) {
            if (!file) return;

            const progressContainer = document.getElementById('file-upload-progress');
            const progressBar = document.getElementById('file-progress-bar');
            const statusText = document.getElementById('file-upload-status');

            progressContainer.classList.remove('hidden');
            
            const formData = new FormData();
            formData.append('file', file);
            formData.append('type', fileType);

            try {
                const response = await fetch('/api/upload', {
                    method: 'POST',
                    body: formData
                });

                if (response.ok) {
                    const result = await response.json();
                    statusText.textContent = 'Upload completed successfully!';
                    progressBar.style.width = '100%';
                    
                    setTimeout(() => {
                        progressContainer.classList.add('hidden');
                        progressBar.style.width = '0%';
                        loadFiles();
                    }, 2000);
                } else {
                    throw new Error('Upload failed');
                }
            } catch (error) {
                console.error('Upload error:', error);
                statusText.textContent = 'Upload failed. Please try again.';
                statusText.classList.add('text-red-600');
            }
        }

        // Update thumbnail preview
        function updateThumbnailPreview() {
            const thumbnailUrl = document.getElementById('video-thumbnail').value;
            const previewContainer = document.getElementById('thumbnail-preview-container');
            const previewImg = document.getElementById('thumbnail-preview');

            if (thumbnailUrl) {
                previewImg.src = thumbnailUrl;
                previewContainer.style.display = 'block';
            } else {
                previewContainer.style.display = 'none';
            }
        }

        // Switch between tabs
        function switchTab(tab) {
            // Reset all tabs
            [videosTab, textsTab, documentsTab, filesTab].forEach(t => {
                t.classList.remove('bg-blue-500', 'text-white');
                t.classList.add('text-gray-600');
            });
            [videosSection, textsSection, documentsSection, filesSection].forEach(s => {
                s.classList.add('hidden');
            });

            if (tab === 'videos') {
                videosTab.classList.add('bg-blue-500', 'text-white');
                videosTab.classList.remove('text-gray-600');
                videosSection.classList.remove('hidden');
                if (currentVideos.length === 0) loadVideos();
            } else if (tab === 'texts') {
                textsTab.classList.add('bg-blue-500', 'text-white');
                textsTab.classList.remove('text-gray-600');
                textsSection.classList.remove('hidden');
                if (currentTexts.length === 0) loadTexts();
            } else if (tab === 'documents') {
                documentsTab.classList.add('bg-blue-500', 'text-white');
                documentsTab.classList.remove('text-gray-600');
                documentsSection.classList.remove('hidden');
                loadDocuments();
            } else if (tab === 'files') {
                filesTab.classList.add('bg-blue-500', 'text-white');
                filesTab.classList.remove('text-gray-600');
                filesSection.classList.remove('hidden');
                loadFiles();
            }
        }

        // Load videos from API
        async function loadVideos() {
            try {
                const response = await fetch('/api/admin/videos');
                const videos = await response.json();
                currentVideos = videos;
                renderVideosList(videos);
            } catch (error) {
                console.error('Error loading videos:', error);
            }
        }

        // Load texts from API
        async function loadTexts() {
            try {
                const response = await fetch('/api/admin/texts');
                const texts = await response.json();
                currentTexts = texts;
                renderTextsList(texts);
            } catch (error) {
                console.error('Error loading texts:', error);
            }
        }

        // Load documents from API
        async function loadDocuments() {
            try {
                const response = await fetch('/api/admin/documents');
                const documents = await response.json();
                currentDocuments = documents;
                renderDocumentsList(documents);
            } catch (error) {
                console.error('Error loading documents:', error);
            }
        }

        // Load files from API
        async function loadFiles() {
            try {
                const response = await fetch('/api/files');
                const files = await response.json();
                currentFiles = files;
                renderFilesList(files);
            } catch (error) {
                console.error('Error loading files:', error);
            }
        }

        // Handle video form submission
        async function handleVideoSubmit(e) {
            e.preventDefault();
            
            const videoData = {
                title: document.getElementById('video-title').value,
                description: document.getElementById('video-description').value,
                video_url: document.getElementById('video-url').value,
                thumbnail_url: document.getElementById('video-thumbnail').value,
                is_published: document.getElementById('video-published').checked,
                order_index: parseInt(document.getElementById('video-order').value) || 0
            };

            try {
                let response;
                if (editingVideoId) {
                    response = await fetch(`/api/videos/${editingVideoId}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(videoData)
                    });
                } else {
                    response = await fetch('/api/videos', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(videoData)
                    });
                }

                if (response.ok) {
                    document.getElementById('video-form').reset();
                    document.getElementById('video-published').checked = true;
                    document.getElementById('thumbnail-preview-container').style.display = 'none';
                    cancelVideoEdit();
                    loadVideos();
                } else {
                    alert('Error saving video');
                }
            } catch (error) {
                console.error('Error saving video:', error);
                alert('Error saving video');
            }
        }

        // Handle text form submission
        async function handleTextSubmit(e) {
            e.preventDefault();
            
            const textData = {
                title: document.getElementById('text-title').value,
                content: document.getElementById('text-content').value,
                excerpt: document.getElementById('text-excerpt').value,
                is_published: document.getElementById('text-published').checked,
                order_index: parseInt(document.getElementById('text-order').value) || 0
            };

            try {
                let response;
                if (editingTextId) {
                    response = await fetch(`/api/texts/${editingTextId}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(textData)
                    });
                } else {
                    response = await fetch('/api/texts', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(textData)
                    });
                }

                if (response.ok) {
                    document.getElementById('text-form').reset();
                    document.getElementById('text-published').checked = true;
                    cancelTextEdit();
                    loadTexts();
                } else {
                    alert('Error saving article');
                }
            } catch (error) {
                console.error('Error saving article:', error);
                alert('Error saving article');
            }
        }

        // Handle document form submission
        async function handleDocumentSubmit(e) {
            e.preventDefault();
            
            const documentData = {
                title: document.getElementById('document-title').value,
                description: document.getElementById('document-description').value,
                file_url: document.getElementById('document-url').value,
                filename: document.getElementById('document-title').value,
                file_type: 'application/octet-stream',
                file_size: 0,
                is_published: document.getElementById('document-published').checked
            };

            try {
                let response;
                if (editingDocumentId) {
                    response = await fetch(`/api/documents/${editingDocumentId}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(documentData)
                    });
                } else {
                    response = await fetch('/api/documents', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(documentData)
                    });
                }

                if (response.ok) {
                    document.getElementById('document-form').reset();
                    document.getElementById('document-published').checked = true;
                    cancelDocumentEdit();
                    loadDocuments();
                } else {
                    alert('Error saving document');
                }
            } catch (error) {
                console.error('Error saving document:', error);
                alert('Error saving document');
            }
        }

        // Edit video
        function editVideo(videoId) {
            const video = currentVideos.find(v => v.id === videoId);
            if (!video) return;

            document.getElementById('video-title').value = video.title;
            document.getElementById('video-description').value = video.description || '';
            document.getElementById('video-url').value = video.video_url;
            document.getElementById('video-thumbnail').value = video.thumbnail_url || '';
            document.getElementById('video-published').checked = video.is_published;
            document.getElementById('video-order').value = video.order_index;

            updateThumbnailPreview();

            editingVideoId = videoId;
            document.getElementById('cancel-video-edit').classList.remove('hidden');
            document.querySelector('#video-form button[type="submit"]').innerHTML = '<i class="fas fa-save mr-2"></i>Update Video';
        }

        // Cancel video edit
        function cancelVideoEdit() {
            editingVideoId = null;
            document.getElementById('cancel-video-edit').classList.add('hidden');
            document.querySelector('#video-form button[type="submit"]').innerHTML = '<i class="fas fa-plus mr-2"></i>Add Video';
            document.getElementById('video-form').reset();
            document.getElementById('video-published').checked = true;
            document.getElementById('thumbnail-preview-container').style.display = 'none';
        }

        // Edit text
        function editText(textId) {
            const text = currentTexts.find(t => t.id === textId);
            if (!text) return;

            document.getElementById('text-title').value = text.title;
            document.getElementById('text-content').value = text.content;
            document.getElementById('text-excerpt').value = text.excerpt || '';
            document.getElementById('text-published').checked = text.is_published;
            document.getElementById('text-order').value = text.order_index;

            editingTextId = textId;
            document.getElementById('cancel-text-edit').classList.remove('hidden');
            document.querySelector('#text-form button[type="submit"]').innerHTML = '<i class="fas fa-save mr-2"></i>Update Article';
        }

        // Cancel text edit
        function cancelTextEdit() {
            editingTextId = null;
            document.getElementById('cancel-text-edit').classList.add('hidden');
            document.querySelector('#text-form button[type="submit"]').innerHTML = '<i class="fas fa-plus mr-2"></i>Add Article';
            document.getElementById('text-form').reset();
            document.getElementById('text-published').checked = true;
        }

        // Edit document
        function editDocument(documentId) {
            const document = currentDocuments.find(d => d.id === documentId);
            if (!document) return;

            document.getElementById('document-title').value = document.title;
            document.getElementById('document-description').value = document.description || '';
            document.getElementById('document-url').value = document.file_url;
            document.getElementById('document-published').checked = document.is_published;

            editingDocumentId = documentId;
            document.getElementById('cancel-document-edit').classList.remove('hidden');
            document.querySelector('#document-form button[type="submit"]').innerHTML = '<i class="fas fa-save mr-2"></i>Update Document';
        }

        // Cancel document edit
        function cancelDocumentEdit() {
            editingDocumentId = null;
            document.getElementById('cancel-document-edit').classList.add('hidden');
            document.querySelector('#document-form button[type="submit"]').innerHTML = '<i class="fas fa-plus mr-2"></i>Add Document';
            document.getElementById('document-form').reset();
            document.getElementById('document-published').checked = true;
        }

        // Delete video
        async function deleteVideo(videoId) {
            if (!confirm('Are you sure you want to delete this video?')) return;
            try {
                const response = await fetch(`/api/videos/${videoId}`, { method: 'DELETE' });
                if (response.ok) loadVideos();
                else alert('Error deleting video');
            } catch (error) {
                alert('Error deleting video');
            }
        }

        // Delete text
        async function deleteText(textId) {
            if (!confirm('Are you sure you want to delete this article?')) return;
            try {
                const response = await fetch(`/api/texts/${textId}`, { method: 'DELETE' });
                if (response.ok) loadTexts();
                else alert('Error deleting article');
            } catch (error) {
                alert('Error deleting article');
            }
        }

        // Delete document
        async function deleteDocument(documentId) {
            if (!confirm('Are you sure you want to delete this document?')) return;
            try {
                const response = await fetch(`/api/documents/${documentId}`, { method: 'DELETE' });
                if (response.ok) loadDocuments();
                else alert('Error deleting document');
            } catch (error) {
                alert('Error deleting document');
            }
        }

        // Delete file
        async function deleteFile(filename) {
            if (!confirm('Are you sure you want to delete this file?')) return;
            try {
                const response = await fetch(`/api/files/${filename}`, { method: 'DELETE' });
                if (response.ok) loadFiles();
                else alert('Error deleting file');
            } catch (error) {
                alert('Error deleting file');
            }
        }

        // Download article
        function downloadArticle(articleId) {
            try {
                const downloadUrl = `/api/download/article/${articleId}`;
                const link = document.createElement('a');
                link.href = downloadUrl;
                link.download = '';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                console.log('Article download started!');
            } catch (error) {
                console.error('Download error:', error);
                alert('Download failed. Please try again.');
            }
        }

        // Render videos list
        function renderVideosList(videos) {
            const videosList = document.getElementById('videos-list');
            
            if (videos.length === 0) {
                videosList.innerHTML = '<p class="text-gray-500 text-center py-8">No videos added yet.</p>';
                return;
            }

            videosList.innerHTML = videos.map(video => `
                <div class="border rounded-lg p-4 hover:shadow-md transition-shadow">
                    <div class="flex justify-between items-start mb-2">
                        <div class="flex-1">
                            <h3 class="font-semibold text-lg">${video.title}</h3>
                            <p class="text-gray-600 text-sm">${video.description || 'No description'}</p>
                        </div>
                        <div class="flex space-x-2 ml-4">
                            <button onclick="editVideo(${video.id})" class="text-blue-500 hover:text-blue-700">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteVideo(${video.id})" class="text-red-500 hover:text-red-700">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4 text-sm text-gray-500">
                        <span class="flex items-center">
                            <i class="fas fa-sort-numeric-up mr-1"></i>
                            Order: ${video.order_index}
                        </span>
                        <span class="flex items-center">
                            <i class="fas fa-${video.is_published ? 'eye' : 'eye-slash'} mr-1"></i>
                            ${video.is_published ? 'Published' : 'Draft'}
                        </span>
                        <span class="flex items-center">
                            <i class="fas fa-calendar mr-1"></i>
                            ${new Date(video.created_at).toLocaleDateString()}
                        </span>
                    </div>
                    ${video.thumbnail_url ? `
                        <div class="mt-3">
                            <img src="${video.thumbnail_url}" class="thumbnail-preview rounded border" alt="Video thumbnail">
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        // Render texts list
        function renderTextsList(texts) {
            const textsList = document.getElementById('texts-list');
            
            if (texts.length === 0) {
                textsList.innerHTML = '<p class="text-gray-500 text-center py-8">No articles added yet.</p>';
                return;
            }

            textsList.innerHTML = texts.map(text => `
                <div class="border rounded-lg p-4 hover:shadow-md transition-shadow">
                    <div class="flex justify-between items-start mb-2">
                        <div class="flex-1">
                            <h3 class="font-semibold text-lg">${text.title}</h3>
                            <p class="text-gray-600 text-sm">${text.excerpt || 'No excerpt'}</p>
                        </div>
                        <div class="flex space-x-2 ml-4">
                            <button onclick="editText(${text.id})" class="text-blue-500 hover:text-blue-700" title="Edit Article">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="downloadArticle(${text.id})" class="text-green-500 hover:text-green-700" title="Download as Text File">
                                <i class="fas fa-download"></i>
                            </button>
                            <button onclick="deleteText(${text.id})" class="text-red-500 hover:text-red-700" title="Delete Article">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4 text-sm text-gray-500">
                        <span class="flex items-center">
                            <i class="fas fa-sort-numeric-up mr-1"></i>
                            Order: ${text.order_index}
                        </span>
                        <span class="flex items-center">
                            <i class="fas fa-${text.is_published ? 'eye' : 'eye-slash'} mr-1"></i>
                            ${text.is_published ? 'Published' : 'Draft'}
                        </span>
                        <span class="flex items-center">
                            <i class="fas fa-calendar mr-1"></i>
                            ${new Date(text.created_at).toLocaleDateString()}
                        </span>
                    </div>
                    <div class="mt-3 text-sm text-gray-600">
                        <p>${text.content.length > 100 ? text.content.substring(0, 100) + '...' : text.content}</p>
                    </div>
                </div>
            `).join('');
        }

        // Render documents list
        function renderDocumentsList(documents) {
            const documentsList = document.getElementById('documents-list');
            
            if (documents.length === 0) {
                documentsList.innerHTML = '<p class="text-gray-500 text-center py-8">No documents added yet.</p>';
                return;
            }

            documentsList.innerHTML = documents.map(doc => `
                <div class="border rounded-lg p-4 hover:shadow-md transition-shadow">
                    <div class="flex justify-between items-start mb-2">
                        <div class="flex-1">
                            <h3 class="font-semibold text-lg flex items-center">
                                <i class="${doc.icon || 'fas fa-file'} mr-2 text-blue-500"></i>
                                ${doc.title}
                            </h3>
                            <p class="text-gray-600 text-sm">${doc.description || 'No description'}</p>
                        </div>
                        <div class="flex space-x-2 ml-4">
                            <button onclick="editDocument(${doc.id})" class="text-blue-500 hover:text-blue-700">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteDocument(${doc.id})" class="text-red-500 hover:text-red-700">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4 text-sm text-gray-500">
                        <span class="flex items-center">
                            <i class="fas fa-download mr-1"></i>
                            Downloads: ${doc.download_count}
                        </span>
                        <span class="flex items-center">
                            <i class="fas fa-${doc.is_published ? 'eye' : 'eye-slash'} mr-1"></i>
                            ${doc.is_published ? 'Published' : 'Draft'}
                        </span>
                        <span class="flex items-center">
                            <i class="fas fa-calendar mr-1"></i>
                            ${new Date(doc.created_at).toLocaleDateString()}
                        </span>
                    </div>
                    <div class="mt-3 flex space-x-2">
                        <a href="${doc.file_url}" target="_blank" class="text-sm bg-green-100 text-green-700 px-3 py-1 rounded hover:bg-green-200 transition-colors">
                            <i class="fas fa-external-link-alt mr-1"></i>View File
                        </a>
                        <a href="/download/${doc.id}" target="_blank" class="text-sm bg-blue-100 text-blue-700 px-3 py-1 rounded hover:bg-blue-200 transition-colors">
                            <i class="fas fa-download mr-1"></i>Download
                        </a>
                    </div>
                </div>
            `).join('');
        }

        // Copy URL to clipboard
        function copyToClipboard(url) {
            navigator.clipboard.writeText(url).then(() => {
                const button = event.target.closest('button');
                const originalText = button.innerHTML;
                button.innerHTML = '<i class="fas fa-check mr-1"></i>Copied!';
                button.classList.add('text-green-500');
                
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.classList.remove('text-green-500');
                    button.classList.add('text-blue-500');
                }, 2000);
            });
        }

        // Render files list
        function renderFilesList(files) {
            const filesList = document.getElementById('files-list');
            
            if (files.length === 0) {
                filesList.innerHTML = '<p class="text-gray-500 col-span-full text-center py-8">No files uploaded yet.</p>';
                return;
            }

            filesList.innerHTML = files.map(file => {
                const isImage = file.type && file.type.startsWith('image/');
                const isVideo = file.type && file.type.startsWith('video/');
                const fileSize = (file.size / 1024 / 1024).toFixed(2);
                
                return `
                    <div class="border rounded-lg p-4 hover:shadow-md transition-shadow">
                        <div class="flex items-center justify-between mb-2">
                            <h3 class="font-semibold text-sm truncate" title="${file.name}">${file.name}</h3>
                            <button onclick="deleteFile('${file.name}')" class="text-red-500 hover:text-red-700">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                        ${isImage ? `<img src="${file.url}" class="w-full h-32 object-cover rounded mb-2" alt="${file.name}">` : ''}
                        ${isVideo ? `<video src="${file.url}" class="w-full h-32 object-cover rounded mb-2" controls></video>` : ''}
                        <div class="text-xs text-gray-500">
                            <p>Size: ${fileSize} MB</p>
                            <p>Type: ${file.type || 'Unknown'}</p>
                            <p>Created: ${new Date(file.created).toLocaleDateString()}</p>
                        </div>
                        <div class="mt-2">
                            <button onclick="copyToClipboard('${file.url}')" class="text-blue-500 hover:text-blue-700 text-xs">
                                <i class="fas fa-copy mr-1"></i>Copy URL
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }
    </script>
</body>
</html>
